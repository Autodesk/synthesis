syntax = "proto3";

enum ResponseType {
	CREATE_LOBBY = 0;
	DELETE_LOBBY = 1;
	START_LOBBY = 2;
	JOIN_LOBBY = 3;
	LEAVE_LOBBY = 4;
	SWAP_LOBBY_SLOT = 5;
}

message KeyExchange {
	string p = 1;
	string g = 2; 
	string public_key = 3;
}


message ServerMessage {
	
	oneof server_msg_type {
                LobbyInfo lobby_info = 1;

		CreateLobbyRequest create_lobby_request = 2;
		DeleteLobbyRequest delete_lobby_request = 3;
		StartLobbyRequest start_lobby_request = 4;
		JoinLobbyRequest join_lobby_request = 5;
		LeaveLobbyRequest leave_lobby_request = 6;
		SwapRequest swap_request = 7;

		GenericLobbyResponse generic_lobby_response = 8;
	}

	message LobbyInfo {
		repeated Lobby lobbies = 1;
		string current_lobby = 2;
		
		message Lobby {
			string lobby_name = 1;
			string lobby_id = 2;
			map<string, string> clients = 3;
		}
	}

	message CreateLobbyRequest {
		string lobby_name = 1;
		string client_id = 2;
	}

	message DeleteLobbyRequest {
		string lobby_id = 1;
		string client_id = 2;
	}

	message StartLobbyRequest {
		string lobby_id = 1;
		string client_id = 2;
	}

	message JoinLobbyRequest {
		string lobby_id = 1;
		string client_id = 2;
	}

	message LeaveLobbyRequest {
		string lobby_id = 1;
		string client_id = 2;
	}

	message SwapRequest {
		string lobby_id = 1;
		int32 new_postion = 2;
	}

	message GenericLobbyResponse {
		ResponseType response_type = 1;
		string lobby_id = 3;
		bool status = 4;
		string status_msg = 5;
	}
}
